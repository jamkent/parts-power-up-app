<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Leaderboard - Parts Power Up</title>
<style>
@font-face {
    font-family: 'Universal Sans';
    src: local('Universal Sans'), sans-serif;
}
body { margin:0; font-family:'Universal Sans', sans-serif; background:radial-gradient(circle at top,#0f172a,#020617); color:white; }
.container { max-width:800px;margin:auto;padding:20px; }
h1{text-align:center;margin-bottom:20px;font-size:32px;}
.leaderboard { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; }
.employee-card { background: #1e293b; padding: 15px; border-radius: 10px; }
.employee-name { font-size: 18px; font-weight: bold; margin-bottom: 10px; }
.progress { width:100%; height:10px; background:#020617; border-radius:5px; overflow:hidden; }
.progress-fill { height:100%; background:linear-gradient(90deg, #ef4444, #22c55e); width:0%; transition:width 0.5s ease; }
.points { text-align: right; font-size: 14px; color: #a1a1aa; margin-top: 5px; }
.footer { text-align: center; margin-top: 30px; font-size: 14px; color: #a1a1aa; }
.footer a { color: #38bdf8; text-decoration: none; }
</style>
</head>
<body>
<div class="container">
    <h1>Parts Power Up Leaderboard</h1>
    <div id="leaderboard" class="leaderboard">
        <!-- Employee data will be loaded here by JavaScript -->
    </div>
    <div class="footer">
        <a href="/">Manager Login</a>
    </div>
</div>

<script>
async function loadLeaderboard() {
    const leaderboardDiv = document.getElementById('leaderboard');
    leaderboardDiv.innerHTML = 'Loading...';

    try {
        const response = await fetch('/api/all_data');
        const data = await response.json();

        leaderboardDiv.innerHTML = ''; // Clear loading message

        data.forEach(employee => {
            const card = document.createElement('div');
            card.className = 'employee-card';

            const name = document.createElement('div');
            name.className = 'employee-name';
            name.textContent = employee.name;

            const progressWrapper = document.createElement('div');
            progressWrapper.className = 'progress';
            const progressFill = document.createElement('div');
            progressFill.className = 'progress-fill';
            
            // Set width after a short delay to allow CSS transition to work on page load
            setTimeout(() => {
                progressFill.style.width = `${employee.points}%`;
            }, 100);
            
            const points = document.createElement('div');
            points.className = 'points';
            points.textContent = `${employee.points} / 100 points`;

            progressWrapper.appendChild(progressFill);
            card.appendChild(name);
            card.appendChild(progressWrapper);
            card.appendChild(points);
            leaderboardDiv.appendChild(card);
        });
    } catch (error) {
        leaderboardDiv.innerHTML = 'Failed to load leaderboard data.';
        console.error('Error loading leaderboard:', error);
    }
}

// Load the data when the page opens
loadLeaderboard();
</script>
</body>
</html>